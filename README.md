# libgaba

GABA provides affine-gap penalty adaptive semi-global banded alignment on nucleotide string graphs. It uses fixed-width adaptive banded semi-global (a variant of Smith-Waterman and Gotoh) algorithm combined with difference DP (an acceleration technique similar to the Myers' bit-parallel editdist algorithm) and X-drop termination.

## Usage



## Functions

### Init / cleanup global context

#### gaba\_init

Global context holds global configurations of the alignment. It can be shared between multiple threads (thread-safe) and must be created once at first.

```
gaba_t *gaba_init(gaba_params_t const *params);
```

#### gaba\_clean

```
void gaba_clean(gaba_t *ctx);
```

### Init / cleanup DP context

#### gaba\_dp\_init

DP context is a local context holding thread-local configurations and working buffers. It can't be shared between threads.

```
struct gaba_dp_context_s *gaba_dp_init(
	gaba_t const *ctx,
	gaba_seq_pair_t const *p);
```

#### gaba\_dp\_flush

Flush the working buffer in the DP context. Any previous result (generated by `gaba_dp_fill` and `gaba_dp_trace`) will be invalid after call.

```
void gaba_dp_flush(
	gaba_dp_t *this,
	gaba_seq_pair_t const *p);
```

#### gaba\_dp\_clean

```
void gaba_dp_clean(
	gaba_dp_t *this);
```

### Alignment functions

#### gaba\_dp\_fill\_root

Create a root section of the extension alignment.

```
gaba_fill_t *gaba_dp_fill_root(
	gaba_dp_t *this,
	gaba_section_t const *a,
	uint32_t apos,
	gaba_section_t const *b,
	uint32_t bpos);
```

#### gaba\_dp\_fill

Extends a section.

```
gaba_fill_t *gaba_dp_fill(
	gaba_dp_t *this,
	gaba_fill_t const *prev_sec,
	gaba_section_t const *a,
	gaba_section_t const *b);
```

#### gaba\_dp\_merge

Merge multiple alignment sections. (not implemented yet)

```
gaba_fill_t *gaba_dp_merge(
	gaba_dp_t *this,
	gaba_fill_t const *sec_list,
	uint64_t tail_list_len);
```

#### gaba\_dp\_trace

Traceback from the max. score in the given sections and concatenate paths at the root.

```
gaba_result_t *gaba_dp_trace(
	gaba_dp_t *this,
	gaba_fill_t const *fw_tail,
	gaba_fill_t const *rv_tail,
	gaba_clip_params_t const *clip);
```

## License

Apache v2.

Copyright (c) 2016 Hajime Suzuki